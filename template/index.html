<!DOCTYPE html>
<html>
<head lang="en">
    <meta charset="UTF-8">
    <title></title>
    <script type="text/javascript" src="/static/smoothie.js"></script>
</head>
<body>
{{ message }}
<canvas id="dashboard" width="600" height="400"></canvas>
<script>
var smoothie = new SmoothieChart();
smoothie.streamTo(document.getElementById("dashboard"));
var line = new TimeSeries();
smoothie.addTimeSeries(line);
function run() {
    var ws = new WebSocket("ws://localhost:9908/ws");
    ws.onopen = function(evt) {
        console.log('Connection open...');
        ws.send('h');
    };

    ws.onmessage = function(evt) {
        console.log(JSON.parse(evt.data).cache);
        line.append(new Date().getTime(), JSON.parse(evt.data).cache);
    };

    ws.onclose = function(evt) {
        console.log(evt.data)
    };
}
</script>
<button onclick="run()">click</button>
</body>
</html>